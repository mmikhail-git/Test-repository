.. _configuration_file:

Структура конфигурационного файла ноды
====================

.. table:: Node configuration
    :widths: 10 10 10 10

    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | Блок параметров      | Параметры                           | Значение                                  | Описание                                                                  |
    +======================+=====================================+===========================================+===========================================================================+
    | | Общий (vostok)     | wavesCrypto                         | | Выбор криптографического алгоритма:     | | Общие параметры настраиваемой сети.                                     |
    | |                    |                                     | | * "yes" - криптография Waves;           | |                                                                         |
    | |                    |                                     | | * "no" - ГОСТ-криптография              | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | directory                         |                                           | | Корневая директория для работы приложения. Значение по умолчанию:       |
    | |                    | |                                   |                                           | | * ${user.home}/vostok/             - для ОС Ubuntu                      |
    | |                    | |                                   |                                           | | * C:/Users/<user_name>/vostok/     - для ОС Windows                     |
    | |                    | |                                   |                                           | | В указанную директорию сохраняются логи ноды и данные сети.             |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | data-directory                    |                                           | | Директория для хранения данных блокчейн-сети. По умолчанию              |
    | |                    | |                                   |                                           | | является поддиректорией каталога ``{directory}/data/``.                 |    
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | leveldb-cache-size                | 256M                                      | | !!! есть описание leveldb-cache-size - одно и то же???                  |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | max-cache-size                    | 100000                                    | | !!! есть описание leveldb-cache-size - одно и то же???                  |
    | |                    | |                                   |                                           | | size of theinternal cache of LevelDB database                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | max-rollback-depth                | 2000                                      | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | remember-blocks-interval-in-cache | 3h                                        | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | blockchain/custom    | address-scheme-character            |                                           | | Идентифицирующий байт сети.                                             |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | blockchain/genesis | genesis-public-key-base-58          | Публичный ключ genesis-блока              | | Параметры genesis-блока настраиваемой сети.                             |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | signature                           | Подпись genesis-блока                     | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | transactions                      | | Начальный баланс участников сети        | | Ненулевой начальный баланс участников сети необходим для начала         |
    | |                    | |                                   | |                                         | | работы блок-чейнсети с использованием алгоритма консенсуса PoS.         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | permisioner                       | | Адрес участника сети, обладающиего      | | Роли пользователей созданных на ноде. Для работы                        |
    | |                    | |                                   | | полномочиями определять роли других     | | узла блокчейн-сети на нем должен быть создан                            |
    | |                    | |                                   | | участников                              | | хотя бы один пользователь.                                              |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | | miner                             | | Адрес участника сети, обладающиего      | |                                                                         |
    | |                    | |                                   | | полномочиями создавать новые блоки      | |                                                                         |
    | |                    | |                                   | |                                         | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | network            | | file                              | |                                         | | Путь к файлу содержащему данные о ???.                                  |
    | |                    | |                                   | |                                         | | Значение по умолчанию - ``{directory}/peers.dat``                       |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | declared-address                  | |                                         | | Строка с IP-адресом и портом, которую нода будет передавать как         |
    | |                    | |                                   | |                                         | | свой внешний адрес при handshake. Может быть назначено автома-          |
    | |                    | |                                   | |                                         | | тически при включенном UPnP.                                            |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | bind-address                      |  Сетевой адрес настраиваемой ноды         | | Сетевые параметры настраиваемого узла сети - адрес и порт               |
    | |                    +-------------------------------------+-------------------------------------------+ | которые "слушает" нода, ожидая подключений.                             |
    | |                    | | port                              | | Порт для подключения к настраиваемой    | |                                                                         |
    | |                    | |                                   | | ноде                                    | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | node-name                         |                                           |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | nonce                             |                                           |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | | known-peers                       | | ["<ip-address>:<port>",                 | | Известные участники сети (ноды). В случае, если данных о                |
    | |                    | |                                   | | "<ip-address>:<port>",                  | | существующих узлах сети нет, необходимо указать пустое                  |
    | |                    | |                                   | | "<ip-address>:<port>"]                  | | значение ``[ ]``.                                                       |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | peers-data-residence-time           | 1d                                        |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | black-list-residence-time           | 15m                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | break-idle-connection-timeout       | 5m                                        |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | max-inbound-connections             | 30                                        |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | max-outbound-connections            | 30                                        |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | max-single-host-connections         | 3                                         |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | connection-timeout                  | 30s                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | max-unverified-peers                | 100                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | enable-peers-exchange               | yes                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | enable-blacklisting                 | yes                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | peers-broadcast-interval            | 2m                                        |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | handshake-timeout                   | 30s                                       |                                                                           |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | suspension-residence-time           | 1m                                        |                                                                           |
    | |                    +------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | received-txs-cache-timeout          | 3m                                        |                                                                           |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | upnp               | | enable                            | no                                        | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | | gateway-timeout                   | 7s                                        | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | | discover-timeout                  | 3s                                        | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | traffic-logger     | | ignore-tx-messages                | no                                        | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | | ignore-rx-messages                | 7s                                        | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | wallet             | | file                              | | Путь до каталога/файла хранения         | | Путь до храненилища ключей участников сети созданных                    |
    | |                    | |                                   | | ключей участников сети созданных на     | | на ноде. При использовании :ref:`ГОСТ-криптографии <crypto-gost>` ключи |
    | |                    | |                                   | | ноде                                    | | хранятся в директории (напиример, ``${user.home}/vostok/keystore/``).   |
    | |                    | |                                   | |                                         | | При использовании :ref:`WAVES-криптографии <crypto-waves>` ключи        |
    | |                    | |                                   | |                                         | | хранятся в файле (напиример, ``${user.home}/vostok/keystore.dat``).     |
    | |                    | |                                   | |                                         | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | |                    | password                            | Пароль для доступа к закрытым ключам      | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | rest-api           | enable                              | Активация REST API ноды                   | | Настройки REST API ноды                                                 |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | bind-address                        | Сетевой адрес REST API ноды               | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | port                                | Порт для подключения к REST API ноды      | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | api-key-hash                        | hash ключа доступа к API ноды             | |                                                                         |
    | |                    +-------------------------------------+-------------------------------------------+ |                                                                         |
    | |                    | cors                                | yes                                       | |                                                                         |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+
    | | miner              | | enable                            | | Активация режима майнинга               | | Блок, позволяющий активировать на ноде возможность создания             |
    | |                    | |                                   | |                                         | | новых блоков                                                            |
    +----------------------+-------------------------------------+-------------------------------------------+---------------------------------------------------------------------------+


Примеры конфигурационного файла ноды
====================

.. table:: Node configuration example
    
    =============================================================================================================  =============================
     Конфигурационный файл                                                                                         Описание                      
    =============================================================================================================  =============================
     `partnerNet.conf <https://github.com/vostokplatform/Vostok-Releases/blob/master/configs/partnerNet.conf>`_    Конфигурационный файл для подключения к существующим общедоступным сетям Vostok
     `example.conf <https://github.com/vostokplatform/Vostok-Releases/blob/master/configs/example.conf>`_          Шаблон конфигурационного файла
    =============================================================================================================  =============================